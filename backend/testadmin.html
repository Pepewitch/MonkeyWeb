
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- <link rel="stylesheet" type="text/css" href="style.css"> -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js"></script>
        <script src="js/sha3.js"></script>
        <script src="js/jquery-1.11.3.min.js"></script>
        <script src="js/global-1.0.0.custom.js" type="text/javascript"></script>
		<script>
			checkLogin();
		//	checkIDTutor();
			checkValidUser("admin");
		</script>
        <script>
            $(document).ready(function(){
                refresh();
                $.post("post/getConfig",function(data){
                    for(var prop in data){
                        if(data.hasOwnProperty(prop)){
                            $("[action=\"post/editConfig\"] [name=\""+prop+"\"]").val(data[prop]);
                        }
                    }
                });
                // $("[action=\"editStudent\"] [type=\"reset\"]").click(function(){
                //     event.preventDefault();
                //     $.post($(this).attr("action"),$(this).find("[name]"),function(data,status){
                //         $("#message").empty();
                //         if(data.err){
                //             $("#message").append("<div id=\"danger\"></div>");
                //             $("#danger").addClass("alert alert-danger").append("Error : "+data.err);
                //         }
                //         else{
                //             $("#message").append("<div id=\"success\"></div>");
                //             $("#success").addClass("alert alert-success");
                //             if($.isEmptyObject(data))$("#success").append("Successful");
                //             else $("#success").html(JSON.stringify(data));
                //         }
                //         refresh();
                //     });
                // })
                $("form").submit(function(event){
                    event.preventDefault();
                    // var input=$(this).find("[name]");
                    var input={};
                    // $(this).find("[name]").each(function(){
                    //     if($(this).attr("type")=="checkbox"||$(this).attr("type")=="day"||$(this).attr("type")=="hour"||$(this).hasClass("array"))return;
                    //     if($(this).attr("type")=="password")input[$(this).attr("name")]=CryptoJS.SHA3($(this).val()).toString();
                    //     else if($(this).attr("type")=="number")input[$(this).attr("name")]=parseInt($(this).val());
                    //     else input[$(this).attr("name")]=$(this).val();
                    // });
                    // $(this).find("[type=checkbox]:checked").each(function(){
                    //     if(input[$(this).attr("name")]==undefined)input[$(this).attr("name")]=[];
                    //     input[$(this).attr("name")].push($(this).val());
                    // });
                    // $(this).find("[type=day]").each(function(){
                    //     if(input[$(this).attr("name")]==undefined)input[$(this).attr("name")]=moment(0).valueOf();
                    //     input[$(this).attr("name")]=moment(input[$(this).attr("name")]).day(parseInt($(this).val())).valueOf();
                    // });
                    // $(this).find("[type=hour]").each(function(){
                    //     if(input[$(this).attr("name")]==undefined)input[$(this).attr("name")]=moment(0).valueOf();
                    //     input[$(this).attr("name")]=moment(input[$(this).attr("name")]).hour(parseInt($(this).val())).valueOf();
                    // });
                    // $(this).find(".array").each(function(){
                    //     if(input[$(this).attr("name")]==undefined)input[$(this).attr("name")]=[];
                    //     if($(this).attr("type")=="number")input[$(this).attr("name")].push(parseInt($(this).val()));
                    //     else input[$(this).attr("name")].push($(this).val());
                    // });
                    var getValue=function(x){
                        if($(x).attr("type")=="checkbox"){
                            if($(x).prop("checked")){
                                if($(x).hasClass("input-int"))return parseInt($(x).val());
                                return $(x).val();
                            }
                        }
                        if($(x).attr("type")=="password")return CryptoJS.SHA3($(x).val()).toString();
                        else if($(x).hasClass("input-day")){
                            if(input[$(x).attr("name")]==undefined)input[$(x).attr("name")]=moment(0).valueOf();
                            return moment(input[$(x).attr("name")]).day(parseInt($(x).val())).valueOf();
                        }
                        else if($(x).hasClass("input-hour")){
                            if(input[$(x).attr("name")]==undefined)input[$(x).attr("name")]=moment(0).valueOf();
                            return moment(input[$(x).attr("name")]).hour(parseInt($(x).val())).valueOf();
                        }
                        else if($(x).attr("type")=="number"||$(x).hasClass("input-int"))return parseInt($(x).val());
                        return $(x).val();
                    };
                    $(this).find("[name]").each(function(){
                        console.log($(this).attr("name"));
                        console.log($(this).val());
                        if($(this).attr("type")=="checkbox"&&!$(this).prop("checked"))return;
                        if($(this).hasClass("input-array")){
                            if(input[$(this).attr("name")]==undefined)input[$(this).attr("name")]=[];
                            input[$(this).attr("name")].push(getValue(this));
                        }
                        else input[$(this).attr("name")]=getValue(this);
                    });
                    console.log("===>",$(this).attr("action"));
                    console.log(input);
                    $.post($(this).attr("action"),input,function(data,status){
                        console.log(data);
                        $("#message").empty();
                        if(data.err){
                            $("#message").append("<div id=\"danger\"></div>");
                            $("#danger").addClass("alert alert-danger").append("Error : "+data.err);
                        }
                        else{
                            $("#message").append("<div id=\"success\"></div>");
                            $("#success").addClass("alert alert-success");
                            if($.isEmptyObject(data))$("#success").append("Successful");
                            else $("#success").html(JSON.stringify(data));
                        }
                        refresh();
                    });
                });
                $(".addTut").click(function(event){
                    event.preventDefault();
                    // $(this).before('<div class="col-sm-11"><select class="form-control input-array" name="tutor" type="number" required><option disabled="" selected="">Select Tutor</option><option value="99001">Tutor#99001</option><option value="99002">Tutor#99002</option></select></div>');
                    $(this).before('<div class="col-sm-11"><input class="form-control input-array" type="number" name="tutor" placeholder="tutor" required></div>');
                    $(this).before('<button class="btn btn-default col-sm-1 removeField">-</button>');
                });
                $(".addCou").click(function(event){
                    event.preventDefault();
                    $(this).before('<div class="col-sm-11"><input class="form-control input-array col-sm-11" name="courseID" type="text" placeHolder="courseID" required></div>');
                    $(this).before('<button class="btn btn-default col-sm-1 removeField">-</button>');
                });
                $(".addSkl").click(function(event){
                    event.preventDefault();
                    $(this).before('<div class="col-sm-3"><input class="form-control input-array" type="text" name="location" placeholder="location" required></div><div class="col-sm-4"><select class="form-control input-array input-day" name="day" required><option disabled="" selected="">Select Day</option><option value="6">Saturday</option><option value="7">Sunday</option></select></div><div class="col-sm-4"><select class="form-control input-array input-hour" name="day" required><option disabled="" selected="">Select Time</option><option value="8">8.00-10.00</option><option value="10">10.00-12.00</option><option value="13">13.00-15.00</option><option value="15">15.00-17.00</option></select></div>');
                    $(this).before('<button class="btn btn-default col-sm-1 removeField">-</button>');
                });
                $("form").on("click",".removeField",function(event){
                    event.preventDefault();
                    $(this).prev().remove();
                    $(this).remove();
                });
            });
            // var refresh=function(){};
            var refresh=function(){
                $("#listUser").empty();
                $.post("debug/listUser",function(data,status){
                    for(var i=0;i<data.length;i++){
                        $("#listUser").append(JSON.stringify(data[i])+"<br><br>");
                    }
                });
                $("#listCourse").empty();
                $.post("debug/listCourse",function(data,status){
                    for(var i=0;i<data.length;i++){
                        $("#listCourse").append(JSON.stringify(data[i])+"<br>");
                        $("#listCourse").append(new Date(data[i].day).toString()+"<br><br>");
                    }
                });
                $("#listHybridSeat").empty();
                $.post("debug/listHybridSeat",function(data,status){
                    for(var i=0;i<data.length;i++){
                        $("#listHybridSeat").append(JSON.stringify(data[i])+"<br>");
                        $("#listHybridSeat").append(new Date(data[i].day).toString()+"<br><br>");
                    }
                });
            };
        </script>
    </head>
    <body>
        <div class="container">
            <div class="panel-group">
                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#listUserDiv">
                        <div class="panel-title">List User</div>
                    </div>
                    <div id="listUserDiv" class="panel-collapse collapse">
                        <div class="panel-body" id="listUser"></div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#listCourseDiv">
                        <div class="panel-title">List Course</div>
                    </div>
                    <div id="listCourseDiv" class="panel-collapse collapse">
                        <div class="panel-body" id="listCourse"></div>
                    </div>
                </div>
                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#listHybridSeatDiv">
                        <div class="panel-title">List HybridSeat</div>
                    </div>
                    <div id="listHybridSeatDiv" class="panel-collapse collapse">
                        <div class="panel-body" id="listHybridSeat"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container" id="message"></div>

        <div class="container">
            <div class="panel-group">
                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#userInformation">
                        <div class="panel-title">User Information</div>
                    </div>
                    <div id="userInformation" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form action="post/password" method="post">
                                <input class="form-control" type="number" name="userID" placeholder="userID" required>
                                <input class="form-control" type="password" name="password" placeholder="Password" required>
                                <button class="btn btn-default" type="submit">post/password</button>
                            </form>
                            <br>
                            <form action="post/name" method="post">
                                <input class="form-control" type="number" name="userID" placeholder="userID" required>
                                <button class="btn btn-default" type="submit">post/name</button>
                            </form>
                            <br>
                            <form action="post/position" method="post">
                                <input class="form-control" type="number" name="userID" placeholder="userID" required>
                                <button class="btn btn-default" type="submit">post/position</button>
                            </form>
                            <br>
                            <form action="post/status" method="post">
                                <input class="form-control" type="number" name="userID" placeholder="userID" required>
                                <button class="btn btn-default" type="submit">post/status</button>
                            </form>
                            <br>
                        </div>
                    </div>
                </div>

                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#studentInformation">
                        <div class="panel-title">Student Information</div>
                    </div>
                    <div id="studentInformation" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form action="post/allStudent" method="post"><!-- TODO TEST -->
                                <button class="btn btn-default" type="submit">post/allStudent</button>
                            </form>
                            <br>
                            <form action="post/studentProfile" method="post"><!-- TODO TEST -->
                                <input class="form-control" type="number" name="studentID" placeholder="studentID" required>
                                <button class="btn btn-default" type="submit">post/studentProfile</button>
                            </form>
                            <br>
                            <form action="post/registrationState" method="post">
                                <input class="form-control" type="number" name="studentID" placeholder="studentID" required>
                                <button class="btn btn-default" type="submit">post/registrationState</button>
                            </form>
                            <br>
                        </div>
                    </div>
                </div>

                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#studentTimetable">
                        <div class="panel-title">Student Timetable</div>
                    </div>
                    <div id="studentTimetable" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form action="post/addStudentCourse" method="post">
                                <input class="form-control" type="number" name="studentID" placeholder="studentID" required>
                                <input class="form-control input-array" type="text" name="courseID" placeholder="courseID" required>
                                <button class="btn btn-default col-sm-1 addCou">+</button>
                                <button class="btn btn-default" type="submit">post/addStudentCourse</button>
                            </form>
                            <br>
                            <form action="post/removeStudentCourse" method="post">
                                <input class="form-control" type="number" name="studentID" placeholder="studentID" required>
                                <input class="form-control input-array" type="text" name="courseID" placeholder="courseID" required>
                                <button class="btn btn-default col-sm-1 addCou">+</button>
                                <button class="btn btn-default" type="submit">post/removeStudentCourse</button>
                            </form>
                            <br>
                            <form action="post/addSkillDay" method="post">
                                <input class="form-control" type="number" name="studentID" placeholder="studentID" required>
                                <input class="form-control input-array" type="text" name="location" placeholder="location" required>
                                <select class="form-control input-array input-day" name="day" required>
                                    <option disabled="" selected="">Select Day</option>
                                    <option value="6">Saturday</option>
                                    <option value="7">Sunday</option>
                                </select>
                                <select class="form-control input-array input-hour" name="day" required>
                                    <option disabled="" selected="">Select Time</option>
                                    <option value="8">8.00-10.00</option>
                                    <option value="10">10.00-12.00</option>
                                    <option value="13">13.00-15.00</option>
                                    <option value="15">15.00-17.00</option>
                                </select>
                                <button class="btn btn-default col-sm-1 addSkl">+</button>
                                <button class="btn btn-default" type="submit">post/addSkillDay</button>
                            </form>
                            <p>addSkillDay TODO</p>
                            <p>removeSkillDay TODO</p>
                            <br>
                            <p>addHybridDay TODO</p>
                            <p>removeHybridDay TODO</p>
                        </div>
                    </div>
                </div>

                <!-- <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#tutorInformation">
                        <div class="panel-title">Tutor Information</div>
                    </div>
                    <div id="tutorInformation" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form action="post/tutorNickname" method="post">
                                <input class="form-control" type="number" name="tutorID" placeholder="tutorID" required>
                                <button class="btn btn-default" type="submit">post/tutorNickname</button>
                            </form>
                            <br>
                        </div>
                    </div>
                </div> -->

                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#userManagement">
                        <div class="panel-title">User Management</div>
                    </div>
                    <div id="userManagement" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form action="post/addStudent" method="post">
                                <input class="form-control" type="password" name="password" placeholder="Password" required>
                                <input class="form-control" type="text" name="firstname" placeholder="Firstname" required>
                                <input class="form-control" type="text" name="lastname" placeholder="Lastname" required>
                                <input class="form-control" type="text" name="nickname" placeholder="Nickname" required>
                                <input class="form-control" type="text" name="firstnameEn" placeholder="FirstnameEn" required>
                                <input class="form-control" type="text" name="lastnameEn" placeholder="LastnameEn" required>
                                <input class="form-control" type="text" name="nicknameEn" placeholder="NicknameEn" required>
                                <input class="form-control" type="email" name="email" placeholder="Email" required>
                                <input class="form-control" type="text" name="phone" placeholder="Phone" required>
                                <input class="form-control" type="number" name="grade" placeholder="Grade" required>
                                <input class="form-control" type="text" name="phoneParent" placeholder="PhoneParent" required>
                                <button class="btn btn-default" type="submit">post/addStudent</button>
                            </form>
                            <br>
                            <form action="post/removeStudent" method="post">
                                <input class="form-control" type="number" name="studentID" placeholder="studentID" required>
                                <button class="btn btn-default" type="submit">post/removeStudent</button>
                            </form>
                            <br>
                            <p>editStudent TODO</p>
                            <br>
                            <form action="post/addTutor" method="post">
                                <input class="form-control" type="password" name="password" placeholder="Password" required>
                                <input class="form-control" type="text" name="firstname" placeholder="Firstname" required>
                                <input class="form-control" type="text" name="lastname" placeholder="Lastname" required>
                                <input class="form-control" type="text" name="nickname" placeholder="Nickname" required>
                                <input class="form-control" type="text" name="firstnameEn" placeholder="FirstnameEn" required>
                                <input class="form-control" type="text" name="lastnameEn" placeholder="LastnameEn" required>
                                <input class="form-control" type="text" name="nicknameEn" placeholder="NicknameEn" required>
                                <input class="form-control" type="email" name="email" placeholder="Email" required>
                                <input class="form-control" type="text" name="phone" placeholder="Phone" required>
                                <button class="btn btn-default" type="submit">post/addTutor</button>
                            </form>
                            <br>
                            <form action="post/removeTutor" method="post">
                                <input class="form-control" type="number" name="tutorID" placeholder="tutorID" required>
                                <button class="btn btn-default" type="submit">post/removeTutor</button>
                            </form>
                            <br>
                            <p>editTutor TODO</p>
                            <br>
                        </div>
                    </div>
                </div>

                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#course">
                        <div class="panel-title">Course</div>
                    </div>
                    <div id="course" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form action="post/allCourse" method="post">
                                <button class="btn btn-default" type="submit">post/allCourse</button>
                            </form>
                            <br>
                            <form action="post/gradeCourse" method="post">
                                <input class="form-control" type="number" name="grade" placeholder="grade" required>
                                <button class="btn btn-default" type="submit">post/gradeCourse</button>
                            </form>
                            <br>
                            <form action="post/courseInfo" method="post">
                                <input class="form-control" type="text" name="courseID" placeholder="courseID" required>
                                <button class="btn btn-default" type="submit">post/courseInfo</button>
                            </form>
                            <br>
                            <form action="post/addCourse" method="post">
                                <input class="form-control" type="text" name="subject" placeholder="subject" required>
                                <!-- <input class="form-control" type="number" name="grade" placeholder="grade" required> -->
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="1">P1</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="2">P2</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="3">P3</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="4">P4</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="5">P5</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="6">P6</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="7">S1</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="8">S2</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="9">S3</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="10">S4</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="11">S5</label>
                                <label class="checkbox-inline"><input class="input-array input-int" type="checkbox" name="grade" value="12">S6</label>
                                <input class="form-control" type="text" name="level" placeholder="level" required>
                                <select class="form-control input-day" name="day" required>
                                    <option disabled="" selected="">Select Day</option>
                                    <option value="6">Saturday</option>
                                    <option value="7">Sunday</option>
                                </select>
                                <select class="form-control input-hour" name="day" required>
                                    <option disabled="" selected="">Select Time</option>
                                    <option value="8">8.00-10.00</option>
                                    <option value="10">10.00-12.00</option>
                                    <option value="13">13.00-15.00</option>
                                    <option value="15">15.00-17.00</option>
                                </select>
                                <!-- <select class="form-control input-array" name="tutor" type="number" required>
                                    <option disabled="" selected="">Select Tutor</option>
                                    <option value="99001">Tutor#99001</option>
                                    <option value="99002">Tutor#99002</option>
                                </select> -->
                                <input class="form-control input-array" type="number" name="tutor" placeholder="tutor" required>
                                <button class="btn btn-default col-sm-1 addTut">+</button>
                                <button class="btn btn-default" type="submit">post/addCourse</button>
                            </form>
                            <br>
                            <form action="post/removeCourse" method="post">
                                <input class="form-control" type="text" name="courseID" placeholder="courseID" required>
                                <button class="btn btn-default" type="submit">post/removeCourse</button>
                            </form>
                            <br>
                            <p>editCourse TODO</p>
                            <br>
                        </div>
                    </div>
                </div>

                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#reciept">
                        <div class="panel-title">Reciept</div>
                    </div>
                    <div id="reciept" class="panel-collapse collapse">
                        <div class="panel-body">
                            <p>submitReceipt TODO</p>
                            <br>
                        </div>
                    </div>
                </div>

                <div class="panel panel-default">
                    <div class="panel-heading" data-toggle="collapse" data-target="#configuration">
                        <div class="panel-title">Configuration</div>
                    </div>
                    <div id="configuration" class="panel-collapse collapse">
                        <div class="panel-body">
                            <form action="post/getConfig" method="post">
                                <button class="btn btn-default" type="submit">post/getConfig</button>
                            </form>
                            <br>
                            <form action="post/editConfig" method="post">
                                <input class="form-control" type="number" name="year" placeholder="year" required>
                                <input class="form-control" type="number" name="quarter" placeholder="quarter" required>
                                <input class="form-control" type="text" name="courseMaterialPath" placeholder="courseMaterialPath" required>
                                <input class="form-control" type="text" name="receiptPath" placeholder="receiptPath" required>
                                <input class="form-control" type="number" name="nextStudentID" placeholder="nextStudentID" required>
                                <input class="form-control" type="number" name="nextTutorID" placeholder="nextTutorID" required>
                                <input class="form-control" type="number" name="maxHybridSeat" placeholder="maxHybridSeat" required>
                                <button class="btn btn-default" type="submit">post/editConfig</button>
                            </form>
                            <br>
                            <form action="post/addStudentGrade" method="post">
                                <input class="form-control" type="number" name="toAdd" placeholder="toAdd" required>
                                <button class="btn btn-default" type="submit">post/addStudentGrade</button>
                            </form>
                            <br>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </body>
</html>
