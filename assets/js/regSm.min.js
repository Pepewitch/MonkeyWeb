var cr=[],csSuggest=[],cookie;const feepersbj=9e3;$(document).ready(function(){cookie=getCookieDict(),$.post("/post/allCourse",{year:2017,quarter:12},function(a){if(a.err)throw alert("Cannot get course data from server"),a.err;log(a.course),addCourse(a.course,cookie.monkeyWebUser);for(let b=0;b<a.course.length;b++)null!==a.course[b].description&&$("#crDescription").append("<p>- "+a.course[b].courseName+" \u0E04\u0E37\u0E2D\u0E04\u0E2D\u0E23\u0E4C\u0E2A"+a.course[b].description+"</p>")}),$(".btn").click(function(){let a=$(".btn-success");$("#total").html("\u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19 : "+feepersbj*a.length+" \u0E1A\u0E32\u0E17")}),$("#group").change(function(){let a=document.getElementsByClassName("btn"),b=$("#group").val();for(let c=0;c<crSuggest.length;c++)if(crSuggest[c].level===b)for(let d=0;d<crSuggest[c].courseID.length;d++)for(let e=0;e<a.length;e++)crSuggest[c].courseID[d]===a[e].id?a[e].addClass("btn-grow"):a[e].removeClass("btn-grow")})});function addCourse(a,b){$.post("/post/studentProfile",{studentID:parseInt(b)},function(c){if(c.err)throw alert("Cannot get student profile from server"),c.err;for(let e in log(c),$.post("post/listCourseSuggestion",{grade:c.grade,quarter:"summer"},function(e){if(0===e.course.length)$("#group-form").hide();else for(let f=0;f<e.course.length;f++)crSuggest.push(e.course[f]),$("#group").append("<option value='"+e.course[f].level+"'>"+e.course[f].level+"</option>")}),$("#name").val(c.firstname+" ("+c.nickname+") "+c.lastname),$("#grade").val(6<c.grade?"\u0E21. "+(c.grade-6):"\u0E1B. "+c.grade),a)if(checkgrade(a[e],c.grade)){cr.push(a[e]);let f=new Date(a[e].day);log(f.getHours());let g=document.getElementsByName(f.getHours());for(let h=0;h<g.length;h++)if("&nbsp;"==g[h].innerHTML){g[h].innerHTML=a[e].courseName+" ("+a[e].tutorNicknameEn[0]+")",g[h].id=a[e].courseID;break}}let d=document.getElementsByClassName("btn");for(let e=0;e<d.length;e++)"&nbsp;"==d[e].innerHTML&&$(d[e]).addClass("disabled")})}function checkgrade(a,b){for(let c in a.grade)if(a.grade[c]==b)return!0}function getCookieDict(){"use strict";let a=document.cookie,b={},c=a.split("; ");for(let d=0;d<c.length;d++)b[c[d].split("=")[0]]=c[d].split("=")[1];return b}function btntoggle(a){if(!$(a).hasClass("disabled"))if(a.className.includes("btn-success"))$(a).addClass("btn-default"),$(a).removeClass("btn-success");else{let b=$("[name="+a.name+"]");for(let c=0;2>c;c++)$(b[c]).removeClass("btn-success"),$(b[c]).addClass("btn-default");$(a).removeClass("btn-default"),$(a).addClass("btn-success")}$(a).blur()}function sendData(){var a=$(".btn-success"),b=[];if(0<a.length){for(let c=0;c<a.length;c++)for(let d in cr){let e=new Date(cr[d].day);cr[d].courseName==a[c].innerHTML.split(" ")[0]&&parseInt(e.getHours())==parseInt(a[c].name)&&b.push(cr[d].courseID)}console.log(b),$.post("/post/addStudentCourse",{studentID:cookie.monkeyWebUser,courseID:b},function(c){if(console.log("eiei"),console.log(c),c.err)throw alert("\u0E01\u0E32\u0E23\u0E40\u0E0A\u0E37\u0E48\u0E2D\u0E21\u0E15\u0E48\u0E2D\u0E21\u0E35\u0E1B\u0E31\u0E0D\u0E2B\u0E32 \u0E42\u0E1B\u0E23\u0E14\u0E25\u0E2D\u0E07\u0E43\u0E2B\u0E21\u0E48\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07"),c.err;$.post("/post/changeRegistrationState",{studentID:parseInt(cookie.monkeyWebUser),registrationState:"untransferred",quarter:"summer"},function(d){if(d.err)throw alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E1A\u0E32\u0E07\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E02\u0E36\u0E49\u0E19 \u0E42\u0E1B\u0E23\u0E14\u0E25\u0E2D\u0E07\u0E43\u0E2B\u0E21\u0E48\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07\u0E2B\u0E23\u0E37\u0E2D\u0E15\u0E34\u0E14\u0E15\u0E48\u0E2DAdmin"),d.err;self.location="summerReceipt"})})}}function confirm(){let a=$(".btn-success");if(console.log(a.length),0<a.length){$("#noSel").hide(),$("#haveSel").show(),$("#confirm").show();let b="";for(let c=0;c<a.length;c++)b+=$(a[c]).html()+"<br>";$(sbj).html(b),$("#fee").html((""+feepersbj*a.length).slice(0,(""+feepersbj*a.length).length-3)+",000 \u0E1A\u0E32\u0E17")}else $("#confirm").hide(),$("#noSel").show(),$("#haveSel").hide()}