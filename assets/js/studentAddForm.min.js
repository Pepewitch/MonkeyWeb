$(document).ready(function(){let a=getCookieDict();$('#datetimepicker1').datetimepicker({format:'DD/MM/YYYY',daysOfWeekDisabled:[1,3,5]}),$.post('post/name',{userID:a.monkeyWebUser},function(b){$('#name').append(' '+b.nickname+' '+b.firstname+' '+b.lastname)}),$('#datetimepicker1').on('dp.change',function(){let c=[],d=[],f=$('.datePicker').data('DateTimePicker').date();$.post('post/studentProfile',{studentID:a.monkeyWebUser}).then(g=>{for(let k,h=0;h<g.hybridDay.length;h++)k=moment(g.hybridDay[h].day),k.day()===f.day()&&(c.push('FHB: '+g.hybridDay[h].subject),d.push(k.format('H:mm')));for(let h=0;h<g.courseID.length;h++)$.post('post/courseInfo',{courseID:g.courseID[h]}).then(k=>{let l=moment(k.day);l.day()===f.day()&&(c.push(k.courseName),d.push(l.format('H:mm')),updateBtn(c,d))});updateBtn(c,d)})}),$('.btn').click(function(){let b=this.className;if(0>b.indexOf('disabled'))if(0<=b.indexOf('btn-default')){for(let c=0;4>c;c++)0>$('.btn'+(c+1)).attr('class').indexOf('disabled')&&0<$('.btn'+(c+1)).attr('class').indexOf('btn-success')&&$('.btn'+(c+1)).attr('class',$('.btn'+(c+1)).attr('class').replace('btn-success','btn-default'));this.className=b.replace('btn-default','btn-success')}else this.className=b.replace('btn-success','btn-default')}),$('#submit').click(function(){let b=!0;for(let d,c=0;4>c;c++)d=$('.btn'+(c+1)),0<=d.attr('class').indexOf('btn-success')&&(b=!1);if(b)alert('\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E41\u0E25\u0E30\u0E40\u0E27\u0E25\u0E32');else if(0>=$('#contact').val().length)alert('\u0E01\u0E23\u0E38\u0E13\u0E32\u0E43\u0E2A\u0E48\u0E0A\u0E37\u0E48\u0E2D\u0E1C\u0E39\u0E49\u0E41\u0E08\u0E49\u0E07');else{$('.modal-body').append('<p>\u0E15\u0E49\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E15\u0E32\u0E21\u0E19\u0E35\u0E49\u0E43\u0E0A\u0E48\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48?</p>');let c=$('#subj').val().slice(0,3)+':'+$('#subj').val().slice(3);for(let f,d=0;4>d;d++)f=$('.btn'+(d+1)),0<=f.attr('class').indexOf('btn-success')&&$('.modal-body').append('<p>'+c+' ('+f.text()+')</p>');$('#confirmModal').modal()}})});function updateBtn(a,b){let c=$('.datePicker').data('DateTimePicker').date(),d=['8:00','10:00','13:00','15:00'],f=['','','','17:00'],g=['8:00-10:00','10:00-12:00','13:00-15:00','15:00-17:00'],h=['-','-','-','17:00-19:00'],k=moment(0);if(k.date(c.date()).month(c.month()).year(c.year()),2===c.day()||4===c.day())for(let l=0;4>l;l++)$('.btn'+(l+1)).html(h[l]),3>l?($('.btn'+(l+1)).attr('class','btn btn-default col-xs-12 disabled btn'+(l+1)),$('.btn'+(l+1)).attr('id','')):(k.hour(f[l].slice(0,-3)).minute('0'),$('.btn'+(l+1)).attr('class','btn btn-default col-xs-12 btn'+(l+1)),$('.btn'+(l+1)).attr('id',k)),$('.modal-body').empty();else for(let l=0;4>l;l++)k.hour(d[l].slice(0,-3)).minute('0'),$('.btn'+(l+1)).html(g[l]),$('.btn'+(l+1)).attr('class','btn btn-default col-xs-12 btn'+(l+1)),$('.btn'+(l+1)).attr('id',k),$('.modal-body').empty();for(let l=0;l<a.length;l++)for(let m=0;4>m;m++)2===c.day()||4===c.day()?b[l]===f[m]&&($('.btn'+(m+1)).html(a[l]+' ('+b[l]+')'),$('.btn'+(m+1)).attr('class','btn btn-warning col-xs-12 disabled btn'+(m+1)),$('.btn'+(m+1)).attr('id','')):b[l]===d[m]&&($('.btn'+(m+1)).html(a[l]+' ('+b[l]+')'),$('.btn'+(m+1)).attr('class','btn btn-warning col-xs-12 disabled btn'+(m+1)),$('.btn'+(m+1)).attr('id','')),$('.modal-body').empty()}function sendData(a){if(4>a){let b=$('.btn'+(a+1));if(0<=b.attr('class').indexOf('btn-success')){let c=getCookieDict(),d=b.attr('id');$.post('post/addStudentPresenceModifier',{studentID:c.monkeyWebUser,day:d,subject:$('#subj').val(),sender:$('#contact').val()}).then(()=>{sendData(a+1)})}else sendData(a+1);3==a&&($('#confirmModal').modal('hide'),location.reload())}}