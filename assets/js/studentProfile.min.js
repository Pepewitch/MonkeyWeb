let loadProfileImg=(()=>{var a=_asyncToGenerator(function*(){let b=yield getConfig(),c=b.profilePicturePath.slice(b.profilePicturePath.search("MonkeyWebData")+14)+ID;$.get(c+".jpg").done(function(){$("#profileImg").attr("src",c+".jpg")}).fail(function(){$.get(c+".png").done(function(){$("#profileImg").attr("src",c+".png")}).fail(function(){$.get(c+".jpeg").done(function(){$("#profileImg").attr("src",c+".jpeg")}).fail(function(){log("can't find picture")})})})});return function(){return a.apply(this,arguments)}})(),genQuarterSelect=(()=>{var a=_asyncToGenerator(function*(){let b=yield listQuarter("public"),c=$("#quarterSelect");for(let d in b.quarter)c.append("<option value='"+b.quarter[d].quarterID+"'>"+b.quarter[d].name+"</option>");c.val(year+(10<=quarter?"":"0")+quarter),genStudentData(),genStudentTimeTable()});return function(){return a.apply(this,arguments)}})(),genStudentData=(()=>{var a=_asyncToGenerator(function*(){$("#studentProfileContent").empty();let b=yield studentProfile(ID),c=$("#quarterSelect").val(),d="\u0E22\u0E31\u0E07\u0E44\u0E21\u0E48\u0E44\u0E14\u0E49\u0E25\u0E07\u0E17\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E19";for(let e in b.quarter)b.quarter[e].year==c.slice(0,4)&&b.quarter[e].quarter==c.slice(4)&&(d=b.quarter[e].registrationState);768<=$(document).width()?$("#studentProfileContent").append("<h4>"+b.firstname+" ("+b.nickname+") "+b.lastname+"</h4><h4>"+b.firstnameEn+" ("+b.nicknameEn+") "+b.lastnameEn+"</h4><h4>ID: "+ID+"</h4><h4>\u0E0A\u0E31\u0E49\u0E19: "+(6<b.grade?"\u0E21."+(b.grade-6):"\u0E1B."+b.grade)+"</h4><h4><span class='fa fa-phone'></span> "+b.phone+"</h4><h4><span class='fa fa-envelope'></span> "+b.email+"</h4><h4>\u0E2A\u0E16\u0E32\u0E19\u0E30: "+d+"</h4>"):$("#studentProfileContent").append("<h6>"+b.firstname+" ("+b.nickname+") "+b.lastname+"</h6><h6>"+b.firstnameEn+" ("+b.nicknameEn+") "+b.lastnameEn+"</h6><h6>ID: "+ID+"</h6><h6>\u0E0A\u0E31\u0E49\u0E19: "+(6<b.grade?"\u0E21."+(b.grade-6):"\u0E1B."+b.grade)+"</h6><h6><span class='fa fa-phone'></span> "+b.phone+"</h6><h6><span class='fa fa-envelope'></span> "+b.email+"</h6><h6>\u0E2A\u0E16\u0E32\u0E19\u0E30: "+d+"</h6>")});return function(){return a.apply(this,arguments)}})(),genStudentTimeTable=(()=>{var a=_asyncToGenerator(function*(){let b=$("#quarterSelect").val();10<=parseInt(b.slice(4))?($("#mainTable").collapse("hide"),$("#summerTable").collapse("show")):($("#summerTable").collapse("hide"),$("#mainTable").collapse("show")),$(".selector").html("&nbsp;").removeClass("cr hb sk");let c=yield $.post("post/v1/studentTimeTable",{studentID:ID,year:b.slice(0,4),quarter:b.slice(4)});for(let d in log(c),c.course){let e=moment(c.course[d].day);$(".btn"+e.day()+"-"+e.hour()).addClass("cr").html(c.course[d].courseName+" - "+c.course[d].tutorName)}for(let d in c.hybrid){let e=moment(c.hybrid[d].day);$(".btn"+e.day()+"-"+e.hour()).addClass("hb").html("FHB:"+c.hybrid[d].subject)}for(let d in c.skill){let e=moment(c.skill[d].day);switch(e.hour()){case 8:case 9:$(".btn"+e.day()+"-8").addClass("sk").html("SK:"+c.skill[d].subject+" - "+e.format("HH:mm"));break;case 10:case 11:$(".btn"+e.day()+"-10").addClass("sk").html("SK:"+c.skill[d].subject+" - "+e.format("HH:mm"));break;case 13:case 14:$(".btn"+e.day()+"-13").addClass("sk").html("SK:"+c.skill[d].subject+" - "+e.format("HH:mm"));break;case 15:case 16:$(".btn"+e.day()+"-15").addClass("sk").html("SK:"+c.skill[d].subject+" - "+e.format("HH:mm"));break;default:$(".btn"+e.day()+"-"+e.hour()).addClass("sk").html("SK:"+c.skill[d].subject+" - "+e.format("HH:mm"));}}});return function(){return a.apply(this,arguments)}})();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),j=h.value}catch(k){return void d(k)}return h.done?void c(j):Promise.resolve(j).then(function(k){e("next",k)},function(k){e("throw",k)})}return e("next")})}}let cookie=getCookieDict(),ID=cookie.monkeyWebUser;loadProfileImg(),genQuarterSelect(),$("#quarterSelect").change(function(){genStudentData(),genStudentTimeTable()}),$("#profileImg").click(function(){}),$("#uploadPicButt").click(function(){confirm("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E01\u0E32\u0E23 upload?")&&uploadImg()});function uploadImg(){let a="",b=$("#file-img"),c=b.val().split(".").pop().toLowerCase();if(-1===$.inArray(c,["png","jpg","jpeg"]))alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E2D\u0E31\u0E1E\u0E44\u0E1F\u0E25\u0E4C .jpg, .jpeg \u0E2B\u0E23\u0E37\u0E2D .png \u0E40\u0E17\u0E48\u0E32\u0E19\u0E31\u0E49\u0E19");else{let d=b.get(0).files,e=new FormData,f=d[0];e.append("file[]",f,f.name),a="post/updateProfilePicture",e.append("userID",ID),$.ajax({url:a,type:"POST",data:e,processData:!1,contentType:!1,success:function(){location.reload()}})}}