let genStudentInfo=(()=>{var a=_asyncToGenerator(function*(){let b=yield studentProfile(ID);$("#nameCard").html(b.nickname+" "+b.firstname),$("#gradeCard").html("\u0E0A\u0E31\u0E49\u0E19: "+(6<b.grade?"\u0E21\u0E31\u0E18\u0E22\u0E21 "+(b.grade-6):"\u0E1B\u0E23\u0E30\u0E16\u0E21 "+b.grade)),$("#levelCard").html("Level: "+b.level),genCrTable()});return function(){return a.apply(this,arguments)}})(),genCrTable=(()=>{var a=_asyncToGenerator(function*(){let b=$("#levelCard").html().slice(6),c=b.slice(0,-1),d=b.slice(-1),e=[1,1,1,1,1,1,1,1];$(".cr-select").html("-").addClass("disabled"),""!=descriptionTitle[parseInt(c)-1]&&$("#descriptionTitle").html("Description: "+descriptionTitle[parseInt(c)-1]);let[f,g]=yield Promise.all([$.post("post/gradeCourse",{year:year,quarter:quarter,grade:c}),$.post("post/listCourseSuggestion",{year:year,quarter:quarter,grade:c})]);for(let h in f.course){let k=moment(f.course[h].day),l=0;0==k.day()&&(l+=4),l+=parseInt((k.hour()-8)/2),$(".btn"+k.day()+"-"+k.hour()+"-"+e[l]).html(f.course[h].courseName+("99000"==f.course[h].tutor[0]?"(HB)":"")),$(".btn"+k.day()+"-"+k.hour()+"-"+e[l]).removeClass("disabled").attr("id",f.course[h].courseID),++e[l],""!=f.course[h].description&&"-"!=f.course[h].description&&$("#crDescription").append("<p>"+f.course[h].courseName+" \u0E04\u0E37\u0E2D "+f.course[h].description+"</p>")}for(let h in g.course)if(g.course[h].level==d)for(let k in g.course[h].courseID)$("#"+g.course[h].courseID[k]).css("box-shadow","0px 0px 5px #64dd17")});return function(){return a.apply(this,arguments)}})(),genFhbTable=(()=>{var a=_asyncToGenerator(function*(){$(".hb-select").addClass("btn-light").removeClass("btn-success").show(),$(".sk-select").addClass("btn-light").removeClass("btn-success").show(),$("#submit-table .sk").hide(),$("#submit-table .hb").hide(),$("#submit-table .cr").hide();let b=[];for(let e=0;e<$("#crRegis-table .btn-success").length;e++)b.push(courseInfo($("#crRegis-table .btn-success")[e].id));let[c,d]=yield Promise.all([$.post("post/v1/listHybridDayInQuarter",{year:year,quarter:quarter}),Promise.all(b)]);for(let e in c){let f=moment(c[e].day);$(".cr"+f.day()+"-"+f.hour()).hide(),$(".fhb"+f.day()+"-"+f.hour()+"-1").attr("id",c[e].hybridID+"(M)"),$(".fhb"+f.day()+"-"+f.hour()+"-2").attr("id",c[e].hybridID+"(P)")}for(let e in d){let f=moment(d[e].day);$(".cr"+f.day()+"-"+f.hour()).html(d[e].courseName+("99000"==d[e].tutor[0]?"(HB)":"")).show(),$(".fhb"+f.day()+"-"+f.hour()+"-1").hide(),$(".fhb"+f.day()+"-"+f.hour()+"-2").hide(),$(".fhb"+f.day()+"-"+f.hour()).hide(),$(".skl"+f.day()+"-"+f.hour()+"-1").hide(),$(".skl"+f.day()+"-"+f.hour()+"-2").hide()}});return function(){return a.apply(this,arguments)}})(),genSkSelect=(()=>{var a=_asyncToGenerator(function*(){$("#skRegis .hb").hide(),$("#submit-table .hb").hide(),$("#submit-table .sk").hide();for(let c,b=0;b<$("#fhbRegis-table .btn-success").length;b++)c=$("#fhbRegis-table .btn-success")[b].className,c=c.slice(c.indexOf("fhb")),c=c.slice(0,c.indexOf(" ")),c=c.slice(0,c.lastIndexOf("-")),$("."+c).html($("#fhbRegis-table .btn-success")[b].innerHTML).show(),c=c.slice(3),$(".skl"+c+"-1").hide(),$(".skl"+c+"-2").hide(),$(".sk"+c).hide()});return function(){return a.apply(this,arguments)}})(),submitData=(()=>{var a=_asyncToGenerator(function*(){$("#loadingModal").modal("show");let b=[];for(let h=0;h<$("#crRegis-table .btn-success").length;h++)b.push($("#crRegis-table .btn-success")[h].id);let c=[];for(let k,h=0;h<$("#fhbRegis-table .btn-success").length;h++)k=$("#fhbRegis-table .btn-success")[h].id,c.push(addHybridStudent(k.slice(0,-3),ID,k.slice(-2,-1)));let d=[];for(let h=0;h<$("#skRegis .btn-success").length;h++){let k=$("#skRegis .btn-success")[h].id,l=$("#skRegis .btn-success")[h].innerHTML.slice(6,7);d.push(addSkillStudent(k,ID,l))}let e=yield addStudentCourse(ID,b),f=yield Promise.all(c),g=yield Promise.all(d);log("cr=>"),log(e),log("fhb=>"),log(f),log("sk=>"),log(g),yield changeRegistrationState(ID,"untransferred",{year:year,quarter:quarter}),self.location="/registrationReceipt"});return function(){return a.apply(this,arguments)}})();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),k=h.value}catch(l){return void d(l)}return h.done?void c(k):Promise.resolve(k).then(function(l){e("next",l)},function(l){e("throw",l)})}return e("next")})}}let pageIndex=1,cookie=getCookieDict(),ID=cookie.monkeyWebUser;$("#fhbRegis-table").hide(),$("#skRegis").hide(),$("#submit-table").hide(),genStudentInfo(),$("#backButt").hide(),$("#backButt").click(function(){changePage(-1)}),$("#nextButt").click(function(){changePage(1)});function changePage(a){if(1==pageIndex)2>$("#crRegis-table .btn-success").length?alert("\u0E15\u0E49\u0E2D\u0E07\u0E25\u0E07\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E19\u0E49\u0E2D\u0E22 2 \u0E04\u0E2D\u0E23\u0E4C\u0E2A"):pageIndex+=a;else if(3==pageIndex){let d=0,e=0;for(let g,f=0;f<$("#skRegis .btn-success").length;f++)g=$("#skRegis .btn-success")[f].innerHTML,0<=g.indexOf("SKILL:M")?d+=1:e+=1;1<d||1<e?alert("\u0E2B\u0E49\u0E32\u0E21\u0E25\u0E07 skill \u0E27\u0E34\u0E0A\u0E32\u0E40\u0E14\u0E35\u0E22\u0E27\u0E01\u0E31\u0E19\u0E2B\u0E25\u0E32\u0E22\u0E40\u0E27\u0E25\u0E32"):pageIndex+=a}else pageIndex+=a;let b=$("#backButt"),c=$("#progressBar");switch(pageIndex){case 1:$("#fhbRegis-table").hide(),$("#crRegis-table").show(),$("#crFeeBox").show(),b.hide(),c.css("width","30%").html("\u0E25\u0E07\u0E17\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E19Course");break;case 2:genFhbTable(),$("#crRegis-table").hide(),$("#crFeeBox").hide(),$("#skRegis").hide(),$("#fhbRegis-table").show(),b.show(),c.css("width","50%").html("\u0E25\u0E07\u0E17\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E19Hybrid");break;case 3:genSkSelect(),$("#submit-table").hide(),$("#fhbRegis-table").hide(),$("#skRegis").show(),b.show(),c.css("width","75%").html("\u0E25\u0E07\u0E17\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E19Skill"),$("#backButt").html("Back"),$("#nextButt").html("Next");break;case 4:genSubmitData(),$("#skRegis").hide(),$("#crFeeBox").show(),$("#submit-table").show(),b.show(),c.css("width","100%").html("\u0E15\u0E23\u0E27\u0E08\u0E2A\u0E2D\u0E1A\u0E04\u0E27\u0E32\u0E21\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07"),$("#backButt").html("\u0E41\u0E01\u0E49\u0E44\u0E02"),$("#nextButt").html("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19");break;case 5:confirm("\u0E22\u0E37\u0E19\u0E22\u0E31\u0E19\u0E01\u0E32\u0E23\u0E25\u0E07\u0E17\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E19")?submitData():changePage(-1);break;default:}}$(".cr-select").click(function(){let a=$("#levelCard").html().slice(6),b=a.slice(0,-1),c=a.slice(-1);$(this).hasClass("disabled")||(12==b?"5a1d0ba242ec5e1710ea9e90"==this.id||"5a1d0c5642ec5e1710ea9e96"==this.id?($("#5a1d0ba242ec5e1710ea9e90").toggleClass("btn-light btn-success"),$("#5a1d0c5642ec5e1710ea9e96").toggleClass("btn-light btn-success")):"5a1d0ae442ec5e1710ea9e87"==this.id||"5a1d0c4c42ec5e1710ea9e95"==this.id?($("#5a1d0ae442ec5e1710ea9e87").toggleClass("btn-light btn-success"),$("#5a1d0c4c42ec5e1710ea9e95").toggleClass("btn-light btn-success")):"5a1d0b0342ec5e1710ea9e88"==this.id||"5a1d0ce042ec5e1710ea9e9d"==this.id?($("#5a1d0b0342ec5e1710ea9e88").toggleClass("btn-light btn-success"),$("#5a1d0ce042ec5e1710ea9e9d").toggleClass("btn-light btn-success")):"5a1d0b8f42ec5e1710ea9e8f"==this.id||"5a1d0cda42ec5e1710ea9e9c"==this.id?($("#5a1d0b8f42ec5e1710ea9e8f").toggleClass("btn-light btn-success"),$("#5a1d0cda42ec5e1710ea9e9c").toggleClass("btn-light btn-success")):"5a1d0b2e42ec5e1710ea9e8a"==this.id?($("#5a1d0c0242ec5e1710ea9e92").toggleClass("btn-light btn-success"),$("#5a1d0b2e42ec5e1710ea9e8a").toggleClass("btn-light btn-success")):"5a1d0b3742ec5e1710ea9e8b"==this.id?($("#5a1d0c0242ec5e1710ea9e92").toggleClass("btn-light btn-success"),$("#5a1d0b3742ec5e1710ea9e8b").toggleClass("btn-light btn-success")):"5a1d0c0242ec5e1710ea9e92"==this.id?"c"==c?($("#5a1d0c0242ec5e1710ea9e92").toggleClass("btn-light btn-success"),$("#5a1d0b3742ec5e1710ea9e8b").toggleClass("btn-light btn-success")):($("#5a1d0c0242ec5e1710ea9e92").toggleClass("btn-light btn-success"),$("#5a1d0b2e42ec5e1710ea9e8a").toggleClass("btn-light btn-success")):$(this).toggleClass("btn-light btn-success"):$(this).toggleClass("btn-light btn-success"),$(this).hasClass("btn-success")&&$($(this).siblings()[0]).hasClass("btn-success")&&(12==b?"5a1d0ba242ec5e1710ea9e90"==$(this).siblings()[0].id||"5a1d0c5642ec5e1710ea9e96"==$(this).siblings()[0].id?($("#5a1d0ba242ec5e1710ea9e90").removeClass("btn-success").addClass("btn-light"),$("#5a1d0c5642ec5e1710ea9e96").removeClass("btn-success").addClass("btn-light")):"5a1d0ae442ec5e1710ea9e87"==$(this).siblings()[0].id||"5a1d0c4c42ec5e1710ea9e95"==$(this).siblings()[0].id?($("#5a1d0ae442ec5e1710ea9e87").removeClass("btn-success").addClass("btn-light"),$("#5a1d0c4c42ec5e1710ea9e95").removeClass("btn-success").addClass("btn-light")):"5a1d0b0342ec5e1710ea9e88"==$(this).siblings()[0].id||"5a1d0ce042ec5e1710ea9e9d"==$(this).siblings()[0].id?($("#5a1d0b0342ec5e1710ea9e88").removeClass("btn-success").addClass("btn-light"),$("#5a1d0ce042ec5e1710ea9e9d").removeClass("btn-success").addClass("btn-light")):"5a1d0b8f42ec5e1710ea9e8f"==$(this).siblings()[0].id||"5a1d0cda42ec5e1710ea9e9c"==$(this).siblings()[0].id?($("#5a1d0b8f42ec5e1710ea9e8f").removeClass("btn-success").addClass("btn-light"),$("#5a1d0cda42ec5e1710ea9e9c").removeClass("btn-success").addClass("btn-light")):"5a1d0b2e42ec5e1710ea9e8a"==$(this).siblings()[0].id?($("#5a1d0c0242ec5e1710ea9e92").removeClass("btn-success").addClass("btn-light"),$("#5a1d0b2e42ec5e1710ea9e8a").removeClass("btn-success").addClass("btn-light")):"5a1d0b3742ec5e1710ea9e8b"==$(this).siblings()[0].id?($("#5a1d0c0242ec5e1710ea9e92").removeClass("btn-success").addClass("btn-light"),$("#5a1d0b3742ec5e1710ea9e8b").removeClass("btn-success").addClass("btn-light")):"5a1d0c0242ec5e1710ea9e92"==$(this).siblings()[0].id?"c"==c?($("#5a1d0c0242ec5e1710ea9e92").removeClass("btn-success").addClass("btn-light"),$("#5a1d0b3742ec5e1710ea9e8b").removeClass("btn-success").addClass("btn-light")):($("#5a1d0c0242ec5e1710ea9e92").removeClass("btn-success").addClass("btn-light"),$("#5a1d0b2e42ec5e1710ea9e8a").removeClass("btn-success").addClass("btn-light")):$(this).siblings().removeClass("btn-success").addClass("btn-light"):$(this).siblings().removeClass("btn-success").addClass("btn-light")),12==b?$("#crFee").html("\u0E23\u0E27\u0E21\u0E40\u0E1B\u0E47\u0E19\u0E40\u0E07\u0E34\u0E19 "+$(".btn-success").length*extraFee+" \u0E1A\u0E32\u0E17"):$("#crFee").html("\u0E23\u0E27\u0E21\u0E40\u0E1B\u0E47\u0E19\u0E40\u0E07\u0E34\u0E19 "+$(".btn-success").length*fee+" \u0E1A\u0E32\u0E17"))}),$(".hb-select").click(function(){$(this).toggleClass("btn-success btn-light"),$(this).hasClass("btn-success")&&$(this).siblings().addClass("btn-light").removeClass("btn-success")}),$(".sk-select").click(_asyncToGenerator(function*(){if($(this).hasClass("btn-light")){$("#skillTime").empty();var a=this.className;a=a.slice(a.indexOf("skl")),a=a.slice(0,a.indexOf(" "));let b=a.slice(3,4),c=a.slice(5,a.lastIndexOf("-")),d=yield $.post("post/v1/listSkillDayInQuarter",{year:year,quarter:quarter});for(let e in d){let f=moment(d[e].day),g=(f.hour()==c||f.hour()==parseInt(c)+1)&&f.day()==b;g&&$("#skillTime").append("<button class='btn btn-primary col' id="+d[e].skillID+" onclick='toggleThat(\""+a+"\",this)'>"+f.format("HH:mm")+"</button>")}$("#skillModal").modal("show")}else $(this).toggleClass("btn-light btn-success")}));function toggleThat(a,b){"1"==a.slice(-1)?$("."+a).html("SKILL:M "+b.innerHTML).toggleClass("btn-light btn-success"):$("."+a).html("SKILL:E "+b.innerHTML).toggleClass("btn-light btn-success"),$("."+a).attr("id",b.id),$("."+a).hasClass("btn-success")&&$("."+a).siblings().removeClass("btn-success").addClass("btn-light"),$("#skillModal").modal("hide")}function genSubmitData(){$("#submit-table .sk").hide();for(let b,a=0;a<$("#skRegis .btn-success").length;a++)b=$("#skRegis .btn-success")[a].className,b=b.slice(b.indexOf("skl")),b=b.slice(0,b.indexOf(" ")),b=b.slice(0,b.lastIndexOf("-")),$(".sk"+b.slice(3)).html($("#skRegis .btn-success")[a].innerHTML).show()}