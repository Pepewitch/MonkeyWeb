let generateStudentHtmlTable=(()=>{var a=_asyncToGenerator(function*(b){let c=document.getElementById("allStudentTable");c.innerHTML="";let d=$("#quarter").val(),e=[];for(let g=0;g<b.length;g++){let h=c.insertRow(g),j=b[g].status,k=b[g].registrationState;"terminated"===j?h.setAttribute("class","table-danger"):"dropped"===j?h.setAttribute("class","table-warning"):"inactive"===j?h.setAttribute("class","table-info"):void 0;"finished"===k&&h.setAttribute("class","table-success");let l=h.insertCell(0),m=h.insertCell(1),n=h.insertCell(2),o=h.insertCell(3),p=h.insertCell(4),q=h.insertCell(5),r=h.insertCell(6);l.innerHTML="<td>"+(g+1)+"</td>",m.innerHTML="<td>"+b[g].studentID+"</td>",n.innerHTML="<td>"+getLetterGrade(b[g].grade)+"</td>",o.innerHTML="<td>"+b[g].nickname+"</td>",p.innerHTML="<td>"+b[g].firstname+"</td>",q.innerHTML="<td>"+b[g].level+"</td>",e.push($.post("post/v1/getRegistrationState",{studentID:b[g].studentID,year:d.slice(0,4),quarter:d.slice(5)})),r.innerHTML="<td>-</td>",r.id="cell7-"+g;h.onclick=function(t){return function(){writeCookie("monkeyWebAdminAllstudentSelectedUser",t.getElementsByTagName("td")[1].innerHTML),self.location="/adminStudentprofile"}}(h)}let f=yield Promise.all(e);for(let g=0;g<f.length;g++)void 0!=f[g].subRegistrationState&&$("#cell7-"+g).html(f[g].subRegistrationState)});return function(){return a.apply(this,arguments)}})();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(c,d){function e(f,g){try{var h=b[f](g),j=h.value}catch(k){return void d(k)}return h.done?void c(j):Promise.resolve(j).then(function(k){e("next",k)},function(k){e("throw",k)})}return e("next")})}}let studentForSearch=[];const getLetterGrade=a=>{return 6>=a?"P"+a:"S"+(a-6)},getDateName=a=>{return["SUN","MON","TUE","WED","THU","FRI","SAT"][a]};$(function(){log($(document).width()),767<$(document).width()&&$("#filterPanel").addClass("position-fixed"),getAllStudentContent()});function quarterChange(){const a=document.getElementById("quarter");writeCookie("monkeyWebSelectedQuarter",a.options[a.selectedIndex].value),getAllStudentContent()}function registrationStateChange(){const a=document.getElementById("stage");writeCookie("monkeyWebSelectedStage",a.value),getAllStudentContent()}function getAllStudentContent(){getConfig().then(a=>{document.getElementById("currentStudentLabel").innerHTML="Current Student: "+(a.nextStudentID-1),loadSelectedMenu(a),studentForSearch=[],allStudent().then(b=>{if(b.err)log("[getAllStudentContent()] : post/allStudent => "+b.err);else{log("[getAllStudentContent()] : post/allStudent => "),log(b);for(let d=0;d<b.student.length;d++)studentForSearch.push({name:b.student[d].nickname+" "+b.student[d].firstname,id:b.student[d].studentID});const c=$(".typeahead");c.typeahead({source:studentForSearch,autoSelect:!0}),c.change(function(){let d=c.typeahead("getActive");d&&(writeCookie("monkeyWebAdminAllstudentSelectedUser",d.id),self.location="/adminStudentprofile")}),position(getCookieDict().monkeyWebUser).then(d=>{let e="public";switch(d.position){case"tutor":case"admin":e="protected";break;case"dev":e="private";}listQuarter(e).then(f=>{generateStudentHtmlTable(filterData(b.student,f,a))})})}})})}function loadSelectedMenu(a){const b=document.getElementById("stage");let c=getCookieDict(),d=[{value:"all",text:"No filter"},{value:"allStage",text:"All Stage"},{value:"unregistered",text:"Unregistered"},{value:"untransferred",text:"Untransferred"},{value:"transferred",text:"Transferred"},{value:"approved",text:"Approved"},{value:"rejected",text:"Rejected"},{value:"pending",text:"Pending"},{value:"finished",text:"Finished"}];b.innerHTML="";for(let g=0;g<d.length;g++)b.innerHTML+="<option value = '"+d[g].value+"'>"+d[g].text+"</option>";b.value=void 0===c.monkeyWebSelectedStage?"all":c.monkeyWebSelectedStage;const e=document.getElementById("quarter");e.innerHTML="";let f="";position(c.monkeyWebUser).then(g=>{switch(g.position){case"tutor":case"admin":f="protected";break;case"dev":f="private";}listQuarter(f).then(h=>{for(let j=0;j<h.quarter.length;j++)e.innerHTML+="<option value = '"+h.quarter[j].year+"-"+h.quarter[j].quarter+"'>"+h.quarter[j].name+"</option>";e.value=void 0===c.monkeyWebSelectedQuarter?a.defaultQuarter.quarter.year+"-"+a.defaultQuarter.quarter.quarter:c.monkeyWebSelectedQuarter})})}function filterData(a,b,c){let d=document.getElementById("quarter"),e=document.getElementById("status"),f=document.getElementById("stage"),g=document.getElementById("grade"),h=document.getElementById("course"),j=getCookieDict();void 0===j.monkeyWebSelectedQuarter&&(j.monkeyWebSelectedQuarter=c.defaultQuarter.quarter.year+"-"+c.defaultQuarter.quarter.quarter);let k=parseInt(j.monkeyWebSelectedQuarter.substring(0,j.monkeyWebSelectedQuarter.indexOf("-"))),l=parseInt(j.monkeyWebSelectedQuarter.substring(j.monkeyWebSelectedQuarter.indexOf("-")+1));return a=a.filter(m=>{if("all"!==f.options[f.selectedIndex].value){let n="unregistered";for(let o=0;o<m.quarter.length;o++)(k=m.quarter[o].year&&l===m.quarter[o].quarter)&&(n=m.quarter[o].registrationState);return"allStage"===f.options[f.selectedIndex].value&&"unregistered"!==n||f.options[f.selectedIndex].value===n}return!0}),"all"!==e.options[e.selectedIndex].value&&("default"===e.options[e.selectedIndex].value?a=a.filter(m=>{return"active"===m.status||"dropped"===m.status}):a=a.filter(m=>{return m.status===e.options[e.selectedIndex].value})),"all"!==g.options[g.selectedIndex].value&&(a=a.filter(m=>m.grade===parseInt(g.options[g.selectedIndex].value))),"all"!==h.options[h.selectedIndex].value&&(a=a.filter(m=>{switch(h.options[h.selectedIndex].value){case"hb":return m.inHybrid;case"cr":return m.inCourse;default:}})),a}function scanStudentBarcode(){let a=document.getElementById("studentID");writeCookie("monkeyWebAdminAllstudentSelectedUser",a.value.substring(0,a.value.length-1)),self.location="/adminStudentprofile"}function createNewStudent(){$.post("/post/addBlankStudent",{number:1}).then(a=>{log(a),document.getElementById("newStudentUsername").innerHTML="Username: "+a.student[0].studentID,document.getElementById("newStudentPassword").innerHTML="Password: "+a.student[0].password,$("#newStudentDialog").modal({backdrop:"static",keyboard:!1})})}function closeNewStudentDialog(){$("#newStudentDialog").modal("hide"),location.reload()}