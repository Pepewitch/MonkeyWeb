'use strict';var cookie,profile,promise=[];$(document).ready(function(){if(cookie=getCookieDict(),cookie.courseID?(cookie.courseID=JSON.parse(cookie.courseID),$('#fee').html('\u0E04\u0E48\u0E32\u0E25\u0E07\u0E17\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E19\u0E04\u0E2D\u0E23\u0E4C\u0E2A : '+fee*cookie.courseID.length+' \u0E1A\u0E32\u0E17')):self.location='/registrationCourse',cookie.Hybrid)for(var a in cookie.Hybrid=JSON.parse(cookie.Hybrid),cookie.Hybrid)cookie.Hybrid[a]=JSON.parse(cookie.Hybrid[a]),fillTable(cookie.Hybrid[a],'hybrid');if($.post('post/allCourse',{quarter:quarter,year:year},function(e){for(var f in e.course)-1<cookie.courseID.indexOf(e.course[f].courseID)&&fillTable(e.course[f])}),promise.push($.post('post/addStudentCourse',{studentID:parseInt(cookie.monkeyWebUser),courseID:cookie.courseID})),cookie.skill)for(var b in cookie.skill=JSON.parse(cookie.skill),cookie.skill)fillTable(cookie.skill[b],'skill');if($('#check').change(function(){$('#check').is(':checked')?$('#reason').hide():$('#reason').show()}),$.post('post/studentProfile',{studentID:parseInt(cookie.monkeyWebUser)},function(e){e.err&&(alert('\u0E02\u0E32\u0E14\u0E01\u0E32\u0E23\u0E40\u0E0A\u0E37\u0E48\u0E2D\u0E21\u0E15\u0E48\u0E2D\u0E08\u0E32\u0E01\u0E40\u0E0B\u0E34\u0E23\u0E4C\u0E1F\u0E40\u0E27\u0E2D\u0E23\u0E4C \u0E01\u0E23\u0E38\u0E13\u0E32\u0E25\u0E2D\u0E07\u0E43\u0E2B\u0E21\u0E48\u0E2D\u0E35\u0E01\u0E04\u0E23\u0E31\u0E49\u0E07'),self.location='/registrationCourse'),profile=e}),cookie.Hybrid)for(var c in cookie.Hybrid)promise.push($.post('post/v1/addHybridStudent',{studentID:parseInt(cookie.monkeyWebUser),subject:cookie.Hybrid[c].subject,hybridID:cookie.Hybrid[c].hybridID}));if(cookie.skill)for(var d in cookie.skill)promise.push($.post('post/v1/addSkillStudent',{studentID:parseInt(cookie.monkeyWebUser),subject:cookie.skill[d].subject,skillID:cookie.skill[d].skillID}))});function fillTable(a,b){var c=new Date(a.day);if('skill'==b){var d=$((6==c.getDay()?'.sat':0==c.getDay()?'.sun':2==c.getDay()?'.tue':4==c.getDay()?'.thu':'')+'[name="'+a.btn+'"]');d.hasClass('skill')?d.html(('M'==a.subject?'Math/':'Eng/')+d.html().split(' ')[0]+'(Skill)'):d.addClass('skill').html(a.text)}else if(6==c.getDay()||0==c.getDay()||2==c.getDay()||4==c.getDay()){var e=$((6==c.getDay()?'.sat':0==c.getDay()?'.sun':2==c.getDay()?'.tue':4==c.getDay()?'.thu':'')+'[name="'+c.getHours()+'"]');'hybrid'==b?e.addClass('hybrid').html('M'==a.subject?'Math(FHB)':'Physics(FHB)'):e.addClass('course').html(a.courseName+'('+a.tutorNicknameEn[0]+')')}}function confirm(){$('#check').is(':checked')||3<$('#reason').val().length?$.post('post/listConference',{},function(a){var b;for(var c in a)-1<a[c].name.indexOf(6<profile.grade?'s':'p')&&(6<profile.grade&&-1<a[c].name.indexOf(profile.grade-6)?b=a[c].conferenceID:-1<a[c].name.indexOf(profile.grade)&&(b=a[c].conferenceID));b&&promise.push($.post('post/addStudentToConference',{conferenceID:b,studentID:parseInt(cookie.monkeyWebUser),isAttended:$('#check').is(':checked'),reason:$('#check').is(':checked')?'':$('#reason').val()})),Promise.all(promise).then(function(d){for(var e in d)if(d[e].err)throw alert('\u0E01\u0E32\u0E23\u0E25\u0E07\u0E17\u0E30\u0E40\u0E1A\u0E35\u0E22\u0E19\u0E21\u0E35\u0E1B\u0E31\u0E0D\u0E2B\u0E32 \u0E01\u0E23\u0E38\u0E13\u0E32\u0E15\u0E34\u0E14\u0E15\u0E48\u0E2D Admin'),d[e].err;$.post('post/changeRegistrationState',{studentID:parseInt(cookie.monkeyWebUser),registrationState:'untransferred',quarter:quarter,year:year}).then(function(){self.location='/registrationReceipt'})})}):alert('\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E40\u0E2B\u0E15\u0E38\u0E1C\u0E25\u0E17\u0E35\u0E48\u0E44\u0E21\u0E48\u0E40\u0E02\u0E49\u0E32\u0E23\u0E48\u0E27\u0E21\u0E01\u0E32\u0E23\u0E2A\u0E2D\u0E1A\u0E41\u0E25\u0E30\u0E1B\u0E23\u0E30\u0E0A\u0E38\u0E21')}