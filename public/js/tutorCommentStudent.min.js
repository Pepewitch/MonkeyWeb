let tutor,cookie,pos;$(document).ready(function(){var a=[];$.post("post/allStudent").then(b=>{for(let c=0;c<b.student.length;c++)"active"===b.student[c].status&&a.push(b.student[c].nickname+" "+b.student[c].firstname+"("+b.student[c].studentID+")");$("#search-box .typeahead").typeahead({source:a})}),cookie=getCookieDict(),tutor=cookie.monkeyWebUser,$.post("post/position",{userID:tutor}).then(b=>{pos=b.position}),cookie.commIndex===void 0&&writeCookie("commIndex",0),log(parseInt(cookie.commIndex)),0===parseInt(cookie.commIndex)&&$(".previous").toggle(),showComment(pos,parseInt(cookie.commIndex))});function postComment(){let a=$("#search-box .typeahead").typeahead("getActive"),b=$("#comment").val();a===void 0?alert("Please Input Student Name"):7<a.length?$.post("post/addStudentComment",{studentID:a.slice(-6,-1),tutorID:tutor,message:$("#comment").val()},function(){location.reload()}):alert("Please Select Correct Name")}function showComment(a,b){$.post("post/listStudentCommentByIndex",{start:b,limit:10}).then(c=>{getName(c,0),10>c.comment.length&&$(".next").toggle()})}function getName(a,b){log("======recur======:"+b),$.post("post/name",{userID:a.comment[b].tutorID}).then(c=>{$.post("post/name",{userID:a.comment[b].studentID}).then(d=>{let e=moment(a.comment[b].timestamp,"x").format("DD MMM");0<a.comment[b].priority?($("#commentList").append("<h4><span class='glyphicon glyphicon-pushpin' style='color:red'></span> "+c.nickname+" -> "+d.nickname+" "+d.firstname+" ("+e+")</h4>"),$("#commentList").append("<p>"+a.comment[b].message+"</p>")):($("#commentList").append("<h4>"+c.nickname+" -> "+d.nickname+" "+d.firstname+" ("+e+")</h4>"),$("#commentList").append("<p>"+a.comment[b].message+"</p>")),b<a.comment.length-1&&getName(a,b+1)})})}function commPosition(a){0<a?(commIndex=parseInt(cookie.commIndex)+10,writeCookie("commIndex",commIndex)):(commIndex=parseInt(cookie.commIndex)-10,writeCookie("commIndex",commIndex)),location.reload()}